{"mappings":"qhBAAA,IAAAA,EAAAC,EAAA,SAEA,MAAMC,EAAO,CACXC,QAASC,SAASC,cAAc,SAChCC,SAAUF,SAASC,cAAc,kBACjCE,QAASH,SAASC,cAAc,iBAChCG,UAAWJ,SAASC,cAAc,mBAClCI,OAAQL,SAASC,cAAc,oBAG3BK,EAAO,CACXC,gBAAiB,KACjBC,SAAU,GA8CZ,SAASC,EAAcD,EAAUE,GAC/B,OAAO,IAAIC,SAAQ,CAACC,EAASC,KACLC,KAAKC,SAAW,GAGpCH,EAAQ,C,SAAEJ,E,MAAUE,IAGpBG,EAAO,C,SAAEL,E,MAAUE,GAAQ,G,CAYjC,SAASM,EAAUR,EAAUE,GAC3BO,EAAArB,GAASsB,OAAOC,QAAQ,uBAAqBX,QAAiBE,M,CAGhE,SAASU,EAASZ,EAAUE,GAC1BO,EAAArB,GAASsB,OAAOG,QAAQ,sBAAoBb,QAAeE,M,CApE7DZ,EAAKO,OAAOiB,iBAAiB,SAASC,IACpCA,EAAGC,kBAKL,SAAsBC,GACpB,IAAIC,EAAQC,OAAO7B,EAAKI,SAAS0B,OAEjCtB,EAAKC,gBAAkBsB,YAAW,KAChCpB,EAAcH,EAAKE,SAAUkB,GAC1BI,MAAK,EAACtB,SAAEA,EAAQE,MAAEA,MACjBM,EAAUR,EAAUE,EAAM,IAE3BqB,OAAM,EAACvB,SAAEA,EAAQE,MAAEA,MAClBU,EAASZ,EAAUE,EAAM,IAG7BJ,EAAKE,UAAY,EAEjBkB,GAASC,OAAO7B,EAAKK,QAAQyB,OAE7BtB,EAAKC,gBAAkByB,aAAY,KACjC,GAAI1B,EAAKE,UAAYiB,EAWnB,OAVAhB,EAAcH,EAAKE,SAAUkB,GAC1BI,MAAK,EAACtB,SAAEA,EAAQE,MAAEA,MACjBM,EAAUR,EAAUE,EAAM,IAE3BqB,OAAM,EAACvB,SAAEA,EAAQE,MAAEA,MAClBU,EAASZ,EAAUE,EAAM,IAG7BgB,GAASC,OAAO7B,EAAKK,QAAQyB,OAErBtB,EAAKE,UAAY,EAEzByB,cAAc3B,EAAKC,iBACnBD,EAAKE,SAAW,C,GAEjBkB,EAAM,GACRA,E,CArCHQ,CADeP,OAAO7B,EAAKM,UAAUwB,OACjB,IAsDU9B,EAA3BC,QAAQuB,iBAAiB,SAASC,IACrCjB,EAAKiB,EAAGY,OAAOC,MAAQT,OAAOJ,EAAGY,OAAOP,OAExCK,cAAc3B,EAAK+B,eAAe","sources":["src/js/03-promises.js"],"sourcesContent":["import Notiflix from 'notiflix';\n\nconst refs = {\n  inpForm: document.querySelector('.form'),\n  inpDelay: document.querySelector('[name=\"delay\"]'),\n  inpStep: document.querySelector('[name=\"step\"]'),\n  inpAmount: document.querySelector('[name=\"amount\"]'),\n  btnSub: document.querySelector('[type=\"submit\"]'),\n};\n\nconst data = {\n  counterInterval: null,\n  position: 1,\n};\n\nrefs.btnSub.addEventListener('click', ev => {\n  ev.preventDefault();\n  const AMOUNT = Number(refs.inpAmount.value);\n  startPromise(AMOUNT);\n});\n\nfunction startPromise(AMOUNT) {\n  let DELAY = Number(refs.inpDelay.value);\n\n  data.counterInterval = setTimeout(() => {\n    createPromise(data.position, DELAY)\n      .then(({ position, delay }) => {\n        onSuccess(position, delay);\n      })\n      .catch(({ position, delay }) => {\n        onReject(position, delay);\n      });\n\n    data.position += 1;\n\n    DELAY += Number(refs.inpStep.value);\n\n    data.counterInterval = setInterval(() => {\n      if (data.position <= AMOUNT) {\n        createPromise(data.position, DELAY)\n          .then(({ position, delay }) => {\n            onSuccess(position, delay);\n          })\n          .catch(({ position, delay }) => {\n            onReject(position, delay);\n          });\n\n        DELAY += Number(refs.inpStep.value);\n\n        return (data.position += 1);\n      } else {\n        clearInterval(data.counterInterval);\n        data.position = 1;\n      }\n    }, DELAY);\n  }, DELAY);\n}\n\nfunction createPromise(position, delay) {\n  return new Promise((resolve, reject) => {\n    const shouldResolve = Math.random() > 0.3;\n    if (shouldResolve) {\n      // Fulfill\n      resolve({ position, delay });\n    } else {\n      // Reject\n      reject({ position, delay });\n    }\n  });\n}\n\n// Считывание введенных данных и запись\nrefs.inpForm.addEventListener('input', ev => {\n  data[ev.target.name] = Number(ev.target.value);\n\n  clearInterval(data.counterTimeout);\n});\n\nfunction onSuccess(position, delay) {\n  Notiflix.Notify.success(`✅ Fulfilled promise ${position} in ${delay}ms`);\n}\n\nfunction onReject(position, delay) {\n  Notiflix.Notify.failure(`❌ Rejected promise ${position} in ${delay}ms`);\n}\n"],"names":["$eWCmQ","parcelRequire","$47d4ff9957288465$var$refs","inpForm","document","querySelector","inpDelay","inpStep","inpAmount","btnSub","$47d4ff9957288465$var$data","counterInterval","position","$47d4ff9957288465$var$createPromise","delay","Promise","resolve","reject","Math","random","$47d4ff9957288465$var$onSuccess","$parcel$interopDefault","Notify","success","$47d4ff9957288465$var$onReject","failure","addEventListener","ev","preventDefault","AMOUNT","DELAY","Number","value","setTimeout","then","catch","setInterval","clearInterval","$47d4ff9957288465$var$startPromise","target","name","counterTimeout"],"version":3,"file":"03-promises.93cfa398.js.map"}